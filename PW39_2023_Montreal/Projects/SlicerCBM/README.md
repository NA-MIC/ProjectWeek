---
layout: pw39-project

permalink: /:path/

project_title: SlicerCBM "Computational Biophysics for Medicine in 3D Slicer"
category: Quantification and Computation
presenter_location: In-person

key_investigators:
- name: Ben Zwick
  affiliation: The University of Western Australia
  country: Australia

- name: Saima Safdar
  affiliation: The University of Western Australia
  country: Australia

- name: Andy Huynh
  affiliation: The University of Western Australia
  country: Australia
---

# Project Description

<!-- Add a short paragraph describing the project. -->

SlicerCBM is an extension for 3D Slicer that provides tools for creating and solving computational models of biophysical systems and processes with a focus on clinical and biomedical applications. Features include grid generation, assignment of material properties and boundary conditions, and solvers for biomechanical modeling and biomechanics-based non-rigid image registration.

## Objective

<!-- Describe here WHAT you would like to achieve (what you will have as end result). -->

1. Package SlicerCBM modules as an installable 3D Slicer extension.

## Approach and Plan

<!-- Describe here HOW you would like to achieve the objectives stated above. -->

1. Complete the requirements for a new 3D Slicer extension (<https://github.com/SlicerCBM/SlicerCBM/issues/8>)

2. Add the SlicerCBM extension to the Slicer Extensions Catalog.

## Progress and Next Steps

<!-- Update this section as you make progress, describing of what you have ACTUALLY DONE.
     If there are specific steps that you could not complete then you can describe them here, too. -->

1. Completed the [SlicerFreeSurferCommands](https://projectweek.na-mic.org/PW39_2023_Montreal/Projects/SlicerFreeSurferCommands/) project, which provides modules that are used in the SlicerCBM workflow.

2. Discussed opportunities for integrating [SlicerCBM](https://slicercbm.org) with [NousNav](https://www.nousnav.org) for image-guided surgery simulations (both as a research tool and for potential clinical applications).

3. Solved the EEG forward problem on the SPL brain atlas mesh created using the [SlicerAtlasEditor](https://github.com/andy9t7/SlicerAtlasEditor) from the [Open Meshed Anatomy](https://projectweek.na-mic.org/PW39_2023_Montreal/Projects/OpenMeshedAnatomy/) project.

4. We will continue working on SlicerCBM next week at PerkLab (Queen's University).

# Illustrations

<!-- Add pictures and links to videos that demonstrate what has been accomplished.
![Description of picture](Example2.jpg)
![Some more images](Example2.jpg)
-->

Flowchart of the patient-specific solution of the iEEG forward problem in deforming brain. Brain shift caused by implantation of electrodes is computed using the biomechanical model. The computed displacement field is used to transform the DTI to the postoperative configuration. This warped DTI is then used as the basis for creating the iEEG forward model.
![fig_flowchart-eeg](https://github.com/NA-MIC/ProjectWeek/assets/33216696/ef320477-0540-460f-8412-122977ef2641)

Original (actual preoperative) and deformed (predicted postoperative) MR images compared with original CT image and electrode positions. Postoperative CT image and electrode positions (white spheres in CT and red points in the slice planes) are overlaid on the (a,b,c) MRI acquired preoperatively and (d,e,f) MRI registered to postoperative configuration of the brain obtained using biomechanics-based image warping.
![fig_mri_ct_elec_unwarped_and_warped](https://github.com/NA-MIC/ProjectWeek/assets/33216696/b860a491-94a2-4c1b-8a8a-c1e3d1bfb42d)

Tissue label maps based on (a,b,c) original preoperative and (d,e,f) deformed by insertion of electrodes postoperative image data. Tissue classes are colored as follows: scalp (pink); skull (yellow); GM (gray); WM (white); and CSF (blue). The location of the electrode grid array can be identified by the line of black voxels in the vicinity of the right temporal and parietal lobes.
![fig_labelmaps](https://github.com/NA-MIC/ProjectWeek/assets/33216696/f41bc134-12e6-42e2-b776-901060c56915)

Mean conductivity (1/3 tr(C)) for models constructed using (a,b,c) original preoperative and (d,e,f) deformed by insertion of electrodes postoperative image data. The ECoG electrode grid substrate is denoted by the purple outline.
![fig_cond_MC](https://github.com/NA-MIC/ProjectWeek/assets/33216696/bd2cff16-6ed8-4e5a-af2e-1155f11a8369)

Streamlines of the electric field generated by a current dipole source located in the temporal lobe of an epilepsy patient. Finite element solution using a regular hexahedral grid implemented in MFEM.
![brain-electric-field](https://github.com/NA-MIC/ProjectWeek/assets/33216696/29a3fe30-4353-49bb-ae91-ec6225eba7f6)

# Background and References

<!-- If you developed any software, include link to the source code repository.
     If possible, also add links to sample data, and to any relevant publications. -->

Code repository and documentation:

- <https://github.com/SlicerCBM/SlicerCBM>
- <https://slicercbm.org>

Sample data:

- Zwick BF, Safdar S, Bourantas GC, Joldes GR, Hyde DE, Warfield SK,
  Wittek A, Miller K. Data for patient-specific solution of the
  electrocorticography forward problem in deforming brain [Data
  set]. Zenodo; 2022. <https://zenodo.org/record/7687631>

Publications:

- Zwick BF, Safdar S, Bourantas GC, Joldes GR, Hyde DE, Warfield SK,
  Wittek A, Miller K. Image data and computational grids for
  computing brain shift and solving the electrocorticography
  forward problem. Data in Brief. 2023;48:109122.
  <https://doi.org/10.1016/j.dib.2023.109122>

- Safdar S, Zwick BF, Yu Y, Bourantas GC, Joldes GR, Warfield SK,
  Hyde DE, Frisken S, Kapur T, Kikinis R, Golby A, Nabavi A,
  Wittek A, Miller K. SlicerCBM: automatic framework for
  biomechanical analysis of the brain. Int J CARS. 2023.
  <https://doi.org/10.1007/s11548-023-02881-7>

- Safdar S, Zwick BF, Bourantas G, Joldes GR, Warfield SK, Hyde DE,
  Wittek A, Miller K. Automatic Framework for Patient-Specific
  Biomechanical Computations of Organ Deformation: An Epilepsy (EEG)
  Case Study. In: Nielsen PMF, Nash MP, Li X, Miller K, Wittek A,
  editors. Computational Biomechanics for Medicine. Cham: Springer
  International Publishing; 2022. p. 75–89.
  <https://doi.org/10.1007/978-3-031-09327-2_5>

- Zwick BF, Bourantas GC, Safdar S, Joldes GR, Hyde DE, Warfield SK,
  Wittek A, Miller K. Patient-specific solution of the
  electrocorticography forward problem in deforming
  brain. NeuroImage. 2022;263:119649.
  <https://doi.org/10.1016/j.neuroimage.2022.119649>

- Yu Y, Safdar S, Bourantas GC, Zwick BF, Joldes GR, Kapur T, Frisken
  S, Kikinis R, Nabavi A, Golby A, Wittek A, Miller K. Automatic
  framework for patient-specific modelling of tumour resection-induced
  brain shift. Comput Biol Med. 2022;143:105271.
  <https://doi.org/10.1016/j.compbiomed.2022.105271>

- Safdar S, Joldes GR, Zwick BF, Bourantas GC, Kikinis R, Wittek A,
  Miller K. Automatic Framework for Patient-Specific Biomechanical
  Computations of Organ Deformation. In: Miller K, Wittek A, Nash M,
  Nielsen PMF, editors. Computational Biomechanics for Medicine. Cham:
  Springer; 2021. p. 3–16.
  <https://doi.org/10.1007/978-3-030-70123-9_1>
